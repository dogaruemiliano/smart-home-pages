(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{322:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return tn}));var r=n(323),o=n(7),a=n(83),i=n(32),c=n(190),s="#011936",u="rgba(1, 25, 54, 0.3)",l="#F4FFFD",d="#F9DC5C",f="#ED254E",p="#FDE9ED",g="#011936",j="#F7A1B2",b="#EB1E47",h="#ffffbf",O="rgba(0, 0, 0, 0)",y="#EBEBE4",m=n(80),x=n(61),w=n.n(x),v=n(81),C=n(6),S=n.n(C),k="https://smart-home-dec.herokuapp.com/";function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=function(){var e=w()((function*(e){return A(e)}));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=w()((function*(e){return A({refresh_token:e.refreshToken,username:e.username},"refresh_token")}));return function(t){return e.apply(this,arguments)}}(),E=function(e){return e.token&&e.createdAt+e.expiresIn>Date.now()},A=function(){var e=w()((function*(e,t){var n=yield fetch("https://smart-home-dec.herokuapp.com/oauth/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T(T({},e),{},{client_id:"Te4030ZzXjxUSSrgJWlmSHFoV9mNDKELin99hi9klIw",grant_type:t||"password"}))});if(!n.ok){var r=yield n.json();throw console.log(r),new Error("Something went wrong, response not ok")}return function(e){return{username:e.username,token:e.access_token,tokenType:e.token_type,refreshToken:e.refresh_token,expiresIn:1e3*e.expires_in,createdAt:1e3*(e.created_at+7200)}}(T(T({},yield n.json()),{},{username:e.username}))}));return function(t,n){return e.apply(this,arguments)}}(),I=n(215),z=n(10),B=n(214),R=function(){var e=w()((function*(){var e="web"===z.default.OS?B.default.getItem:I.getItemAsync;try{var t=yield e("authData");if(console.log(t),null!==t)return JSON.parse(t)}catch(n){console.log(n)}return null}));return function(){return e.apply(this,arguments)}}(),F=function(){var e=w()((function*(e){var t="web"===z.default.OS?B.default.setItem:I.setItemAsync,n=JSON.stringify(e);try{yield t("authData",n)}catch(r){return!1}return!0}));return function(t){return e.apply(this,arguments)}}(),N=Object(m.createAsyncThunk)("auth/login",function(){var e=w()((function*(e){try{var t=yield L(e);return F(t),t}catch(n){throw new Error(n)}}));return function(t){return e.apply(this,arguments)}}()),W=Object(m.createAsyncThunk)("auth/refreshToken",function(){var e=w()((function*(e,t){try{var n=t.getState().auth,r=yield D(e||n);return F(r),r}catch(o){throw new Error(o)}}));return function(t,n){return e.apply(this,arguments)}}()),H=Object(m.createAsyncThunk)("auth/logout",w()((function*(){F(null)}))),V={username:"",token:"",tokenType:"",refreshToken:"",createdAt:0,expiresIn:0,isLoading:!1},M=Object(m.createSlice)({name:"auth",initialState:V,reducers:{setAuthState:function(e,t){e.username=t.payload.username,e.token=t.payload.token,e.tokenType=t.payload.tokenType,e.refreshToken=t.payload.refreshToken,e.createdAt=t.payload.createdAt,e.expiresIn=t.payload.expiresIn}},extraReducers:function(e){e.addCase(N.pending,(function(e){e.isLoading=!0})),e.addCase(N.fulfilled,(function(e,t){console.log("login.fullfilled"),e.createdAt=t.payload.createdAt,e.expiresIn=t.payload.expiresIn,e.token=t.payload.token,e.refreshToken=t.payload.refreshToken,e.tokenType=t.payload.tokenType,e.isLoading=!1})),e.addCase(N.rejected,(function(e,t){v.default.alert("There was an error",t.error.message,[{text:"Close",style:"cancel"}]),e.isLoading=!1})),e.addCase(W.pending,(function(e){e.isLoading=!0})),e.addCase(W.fulfilled,(function(e,t){e.createdAt=t.payload.createdAt,e.expiresIn=t.payload.expiresIn,e.token=t.payload.token,e.refreshToken=t.payload.refreshToken,e.tokenType=t.payload.tokenType,e.isLoading=!1})),e.addCase(W.rejected,(function(e,t){v.default.alert("There was an error",t.error.message,[{text:"Close",style:"cancel"}]),e.isLoading=!1})),e.addCase(H.pending,(function(e){e.isLoading=!0})),e.addCase(H.fulfilled,(function(e){e.createdAt=V.createdAt,e.expiresIn=V.expiresIn,e.token=V.token,e.refreshToken=V.refreshToken,e.tokenType=V.tokenType,e.isLoading=!1})),e.addCase(H.rejected,(function(e,t){v.default.alert("There was an error",t.error.message,[{text:"Close",style:"cancel"}])}))}}),_=M.actions.setAuthState,J=M.reducer,U=[{points:[[0,0],[990,0]]},{points:[[0,0],[0,100]]},{points:[[0,100],[270,100]]},{points:[[270,100],[270,260]]},{points:[[270,260],[460,260]]},{points:[[460,470],[460,780]]},{points:[[460,100],[460,400]]},{points:[[370,260],[370,520]]},{points:[[370,520],[460,520]]},{points:[[460,360],[490,360]]},{points:[[550,360],[910,360]]},{points:[[970,360],[990,360]]},{points:[[990,0],[990,780]]},{points:[[460,520],[490,520]]},{points:[[550,520],[830,520]]},{points:[[890,360],[890,520]]},{points:[[870,520],[898,520]]},{points:[[650,520],[650,780]]},{points:[[460,780],[998,780]]}],X=[{properties:{id:"Hall 1",name:"Hall 1",isLightOn:!1,empty:!1},geometry:{type:"Polygon",coordinates:[[[0,0],[0,100],[270,0],[270,100]]]}},{properties:{id:"Kitchen",name:"Kitchen",isLightOn:!1,empty:!1},geometry:{type:"Polygon",coordinates:[[[270,0],[270,260],[460,0],[460,260]]]}},{properties:{id:"Living",name:"Living",isLightOn:!1,empty:!1},geometry:{type:"Polygon",coordinates:[[[460,0],[460,360],[990,0],[990,360]]]}},{properties:{id:"Empty 1",name:"Empty 1",isLightOn:!1,empty:!0},geometry:{type:"Polygon",coordinates:[[[370,260],[370,330],[460,260],[460,330]]]}},{properties:{id:"Bath 1",name:"Bath 1",isLightOn:!1,empty:!1},geometry:{type:"Polygon",coordinates:[[[370,330],[370,520],[460,330],[460,520]]]}},{properties:{id:"Hall 2",name:"Hall 2",isLightOn:!1,empty:!1},geometry:{type:"Polygon",coordinates:[[[460,360],[460,520],[560,360],[560,520]]]}},{properties:{id:"Empty 2",name:"Empty 2",isLightOn:!1,empty:!0},geometry:{type:"Polygon",coordinates:[[[560,360],[560,520],[650,360],[650,520]]]}},{properties:{id:"Empty 3",name:"Empty 3",isLightOn:!1,empty:!0},geometry:{type:"Polygon",coordinates:[[[650,360],[650,380],[890,360],[890,380]]]}},{properties:{id:"Bath 2",name:"Bath 2",isLightOn:!1,empty:!1},geometry:{type:"Polygon",coordinates:[[[650,380],[650,520],[890,380],[890,520]]]}},{properties:{id:"Office",name:"Office",isLightOn:!1,empty:!1},geometry:{type:"Polygon",coordinates:[[[460,520],[460,780],[650,520],[650,780]]]}},{properties:{id:"Room",name:"Room",isLightOn:!1,empty:!1},geometry:{type:"Polygon",coordinates:[[[890,360],[890,520],[990,360],[990,520]],[[650,520],[650,780],[990,520],[990,780]]]}}],K=(Object(m.createAsyncThunk)("home/fetchData",(function(){return X})),Object(m.createSlice)({name:"home",initialState:{rooms:[]},reducers:{setState:function(e,t){e.rooms=X},toggleLight:function(e,t){var n=e.rooms.findIndex((function(e){return e.properties.id===t.payload.roomId}));e.rooms[n].properties.isLightOn=!e.rooms[n].properties.isLightOn}},extraReducers:function(e){}})),Y=K.actions,Z=(Y.setState,Y.toggleLight),G=K.reducer,q=["auto","heat","cool","dry","fan"],Q=["low","medium","high","auto"],$=function(e){var t,n;switch(e){case"dry":case"cool":t=19,n=30;break;case"heat":t=17,n=28;break;case"auto":t=17,n=30;break;case"fan":default:return null}return{min:t,max:n}},ee=function(e){return Object(m.createAsyncThunk)("ac/"+e,function(){var t=w()((function*(t,n){var r="";if(E(n.getState().auth))r="Bearer "+n.getState().auth.token;else{var o=yield D({refreshToken:n.getState().auth.refreshToken,username:n.getState().auth.username});n.dispatch(_(o)),r="Bearer "+o.token}try{if(!(yield function(e,t){return fetch(k+"api/v1/"+e.replace(/[A-Z]/g,(function(e){return"_"+e.toLowerCase()})),{method:"POST",headers:{Authorization:t}})}(e,r)).ok)return!1}catch(a){throw console.log(a),new Error(a.message)}return console.log(e+" in the state"),!0}));return function(e,n){return t.apply(this,arguments)}}())},te=ee("raiseTemperature"),ne=ee("lowerTemperature"),re=ee("togglePower"),oe=ee("changeFanSpeed"),ae=ee("changeMode"),ie=Object(m.createAsyncThunk)("ac/fetchAcState",w()((function*(){try{var e=yield fetch(k+"api/v1/ac");if(!e.ok)throw new Error("Getting the ac state from server failed");return yield e.json()}catch(t){throw new Error(t.message)}}))),ce=Object(m.createSlice)({name:"ac",initialState:{isLoading:!0,correctionMode:!1,settings:{power:!1,mode:"cool",temperature:20,fanSpeed:"low"}},reducers:{toggleCorrectionMode:function(e){e.correctionMode=!e.correctionMode},setAcState:function(e,t){var n=t.payload;e.settings.power=n.power,e.settings.mode=n.mode,e.settings.fanSpeed=n.fanSpeed,e.settings.temperature=n.temperature}},extraReducers:function(e){e.addCase(ie.pending,(function(e){e.isLoading=!0})),e.addCase(ie.fulfilled,(function(e,t){t.payload&&(e.settings.mode=t.payload.mode,e.settings.fanSpeed=t.payload.fanSpeed,e.settings.power=t.payload.power,e.settings.temperature=t.payload.temperature),e.isLoading=!1})),e.addCase(ie.rejected,(function(e,t){v.default.alert("There was an error",t.error.message,[{text:"Close",style:"cancel"}]),e.isLoading=!1})),e.addCase(re.pending,(function(e){e.isLoading=!0})),e.addCase(re.fulfilled,(function(e,t){t.payload&&(e.settings.power=!e.settings.power),e.isLoading=!1})),e.addCase(re.rejected,(function(e,t){v.default.alert("There was an error",t.error.message,[{text:"Close",style:"cancel"}]),e.isLoading=!1})),e.addCase(te.pending,(function(e){e.isLoading=!0})),e.addCase(te.fulfilled,(function(e,t){var n,r=null==(n=$(e.settings.mode))?void 0:n.max,o=e.settings.temperature;t.payload&&r&&o&&o<r&&(e.settings.temperature+=1),e.isLoading=!1})),e.addCase(te.rejected,(function(e,t){v.default.alert("There was an error",t.error.message,[{text:"Close",style:"cancel"}]),e.isLoading=!1})),e.addCase(ne.pending,(function(e){e.isLoading=!0})),e.addCase(ne.fulfilled,(function(e,t){var n,r=null==(n=$(e.settings.mode))?void 0:n.min,o=e.settings.temperature;t.payload&&r&&o&&o>r&&(e.settings.temperature-=1),e.isLoading=!1})),e.addCase(ne.rejected,(function(e,t){v.default.alert("There was an error",t.error.message,[{text:"Close",style:"cancel"}]),e.isLoading=!1})),e.addCase(oe.pending,(function(e){e.isLoading=!0})),e.addCase(oe.fulfilled,(function(e,t){var n=Q.findIndex((function(t){return t===e.settings.fanSpeed}));t.payload&&(e.settings.fanSpeed=Q[(n+1)%Q.length]),e.isLoading=!1})),e.addCase(oe.rejected,(function(e,t){v.default.alert("There was an error",t.error.message,[{text:"Close",style:"cancel"}]),e.isLoading=!1})),e.addCase(ae.pending,(function(e){e.isLoading=!0})),e.addCase(ae.fulfilled,(function(e,t){var n=q.findIndex((function(t){return t===e.settings.mode}));if(t.payload){e.settings.mode=q[(n+1)%q.length];var r=$(e.settings.mode);r&&e.settings.temperature<r.min&&(e.settings.temperature=null==r?void 0:r.min),r&&e.settings.temperature>r.max&&(e.settings.temperature=r.max)}e.isLoading=!1})),e.addCase(ae.rejected,(function(e,t){v.default.alert("There was an error",t.error.message,[{text:"Close",style:"cancel"}]),e.isLoading=!1}))}}),se=ce.actions,ue=se.toggleCorrectionMode,le=se.setAcState,de=ce.reducer,fe=Object(m.configureStore)({reducer:{auth:J,home:G,ac:de}}),pe=n(11),ge=n.n(pe),je=n(487),be=n(0),he=n(477),Oe=n(23),ye=n.n(Oe),me=n(8),xe=n(38),we=n(267),ve=n(64),Ce=n(52),Se=n(5);function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Te=function(e){var t=e.onPress,n=e.isLoading,r=(e.disabled,e.children),o=e.margin,a=Pe(Pe({},Le.button),{},{margin:o});return Object(Se.jsx)(ve.default,{style:function(e){var t=e.pressed;return[a,t&&Le.pressed]},onPress:t,disabled:!!n,children:Object(Se.jsx)(me.default,{children:n?Object(Se.jsx)(we.default,{size:"small",color:l}):Object(Se.jsx)(Ce.default,{style:Le.buttonText,children:r})})})},Le=o.default.create({button:{borderRadius:6,paddingVertical:8,paddingHorizontal:12,backgroundColor:s,elevation:2,shadowColor:"black",shadowOffset:{width:1,height:1},shadowOpacity:.25,shadowRadius:4},pressed:{opacity:.7},buttonText:{textAlign:"center",color:l,fontSize:16,fontWeight:"500"}}),De=n(173);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ie=function(e){var t=e.label,n=e.keyboardType,r=e.secure,o=e.onUpdateValue,a=e.value,i=e.isInvalid;return Object(Se.jsxs)(me.default,{style:ze.inputContainer,children:[Object(Se.jsx)(Ce.default,{style:[ze.label,i&&ze.labelInvalid],children:t}),Object(Se.jsx)(De.default,Ae({style:[ze.input,i&&ze.inputInvalid],autoCapitalize:"none",keyboardType:n,secureTextEntry:r,onChangeText:o,value:a},e))]})},ze=o.default.create({inputContainer:{marginVertical:8,borderBottomColor:s,borderBottomWidth:1},label:{color:s,marginBottom:4},labelInvalid:{color:b},input:{paddingVertical:8,paddingHorizontal:6,backgroundColor:l,borderRadius:4,fontSize:16},inputInvalid:{backgroundColor:j}});function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fe=function(e){var t=e.isLogin,n=e.onSubmit,r=e.credentialsInvalid,o=Object(be.useState)({username:"",password:""}),a=ge()(o,2),c=a[0],s=a[1],u=Object(i.useSelector)((function(e){return e.auth.isLoading})),l=r.username,d=r.password,f=function(e,t){console.log("updateInputValueHandler",t),s((function(n){return Re(Re({},n),{},S()({},e,t))}))},p=function(){var e=w()((function*(){try{n({username:c.username.toLowerCase(),password:c.password})}catch(e){throw console.log(e),new Error(e)}}));return function(){return e.apply(this,arguments)}}();return Object(Se.jsx)(me.default,{style:Ne.form,children:Object(Se.jsxs)(me.default,{children:[Object(Se.jsx)(Ie,{label:"Username",onUpdateValue:function(e){return f("username",e)},value:c.username,isInvalid:l}),Object(Se.jsx)(Ie,{label:"Password",onUpdateValue:function(e){return f("password",e)},secure:!0,value:c.password,isInvalid:d}),Object(Se.jsx)(me.default,{style:Ne.buttons,children:Object(Se.jsx)(Te,{onPress:p,isLoading:u,children:t?"Log In":"Sign Up"})})]})})},Ne=o.default.create({form:{},buttons:{marginTop:12}}),We=function(e){var t=e.isLogin,n=e.onAuthenticate,r=(Object(xe.useNavigation)().navigate,Object(be.useState)({username:!1,password:!1})),o=ge()(r,2),a=o[0],i=o[1];return Object(Se.jsx)(me.default,{style:He.authContent,children:Object(Se.jsx)(Fe,{isLogin:t,onSubmit:function(e){var t=e.username,r=e.password;t=t.trim(),r=r.trim();var o=t.length>=3,a=r.length>6;if(!o||!a)return v.default.alert("Invalid input","Please check your entered credentials."),void i({username:!o,password:!a});n({username:t,password:r})},credentialsInvalid:a})})},He=o.default.create({authContent:{marginTop:64,marginHorizontal:32,padding:16,borderRadius:8,backgroundColor:l,elevation:2,shadowColor:"black",shadowOffset:{width:1,height:1},shadowOpacity:.35,shadowRadius:4},buttons:{marginTop:8}}),Ve=function(e){var t=Object(i.useDispatch)();return Object(Se.jsx)(We,{isLogin:!0,onAuthenticate:function(e){return ye.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:try{t(N(e))}catch(r){console.log(r)}case 1:case"end":return n.stop()}}),null,null,null,Promise)}})},Me=Object(he.default)(),_e=function(){return Object(Se.jsx)(Me.Navigator,{screenOptions:{headerStyle:{backgroundColor:s},headerTintColor:g,headerShadowVisible:!1,contentStyle:{backgroundColor:s}},children:Object(Se.jsx)(Me.Screen,{name:"Login",component:Ve})})},Je=n(481),Ue=n(295),Xe=n(297),Ke=n(311),Ye=n(480),Ze=n(478),Ge=o.default.create({component:{paddingHorizontal:11}}),qe=function(e){var t=Object(i.useDispatch)(),n=Object(i.useSelector)((function(e){return e.ac.correctionMode}));return Object(Se.jsx)(ve.default,{onPress:function(){return t(ue())},style:Ge.component,children:Object(Se.jsx)(Ze.default,{name:n?"ios-settings":"ios-settings-outline",size:24,color:l})})},Qe=function(e){return o.default.create({component:{width:112,height:64,borderRadius:8,justifyContent:"center",alignItems:"center",backgroundColor:e?O:l,outlineStyle:"none",shadowRadius:8,shadowOpacity:e?0:.4,shadowOffset:{height:4,width:0},elevation:e?0:1}}).component},$e=function(e){var t=e.children,n=e.dispatchAction,r=e.empty,o=Object(i.useDispatch)(),a=Object(i.useSelector)((function(e){return e.ac.correctionMode})),c=Object(i.useSelector)((function(e){return e.ac.isLoading}));return Object(Se.jsx)(ve.default,{onPress:function(){c||o(n(a))},onLongPress:function(){o(n(!0))},style:Qe(r),children:t})},et=n(488),tt=function(e){var t=Object(i.useSelector)((function(e){return e.ac.settings.power}));return Object(Se.jsx)($e,{dispatchAction:oe,empty:!t,children:Object(Se.jsx)(et.default,{name:"fan",size:48,color:g})})},nt=n(479),rt=o.default.create({text:{color:g,fontWeight:"bold"},mainContainer:{flexDirection:"column",flex:1,width:"100%",justifyContent:"space-around"},topContainer:{flexDirection:"row",justifyContent:"center",alignItems:"center"},bottomContainer:{flexDirection:"row",justifyContent:"center",alignItems:"center"},icon:{marginHorizontal:2}}),ot=function(e){var t=Object(i.useSelector)((function(e){return e.ac.settings.power}));return Object(Se.jsx)($e,{dispatchAction:ae,empty:!t,children:Object(Se.jsxs)(me.default,{style:rt.mainContainer,children:[Object(Se.jsxs)(me.default,{style:rt.topContainer,children:[Object(Se.jsx)(et.default,{name:"snowflake",size:18,color:g,style:rt.icon}),Object(Se.jsx)(Ze.default,{name:"water",size:18,color:g,style:rt.icon}),Object(Se.jsx)(et.default,{name:"fan",size:18,color:g,style:rt.icon})]}),Object(Se.jsxs)(me.default,{style:rt.bottomContainer,children:[Object(Se.jsx)(et.default,{name:"sun",size:18,color:g,style:rt.icon}),Object(Se.jsx)(nt.default,{name:"brightness-auto",size:18,color:g,style:rt.icon})]})]})})},at=n(60),it=o.default.create({image:{height:48,width:48}}),ct=function(e){var t=Object(i.useSelector)((function(e){return e.ac.settings.power}));return Object(Se.jsx)($e,{dispatchAction:re,children:t?Object(Se.jsx)(at.default,{source:n(378),style:it.image}):Object(Se.jsx)(at.default,{source:n(379),style:it.image})})};function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var lt=o.default.create({arrow:{width:0,height:0,borderStartWidth:16,borderStartColor:"rgba(0, 0, 0, 0)",borderEndWidth:16,borderEndColor:"rgba(0, 0, 0, 0)",borderBottomWidth:16,borderBottomColor:g},up:{transform:[{rotate:"0deg"}]},down:{transform:[{rotate:"180deg"}]}}),dt=function(e){var t=e.direction;return Object(Se.jsx)(me.default,{style:ut(ut({},lt.arrow),lt[t])})},ft=o.default.create({imageContainer:{flex:1,justifyContent:"center",alignItems:"center",flexDirection:"row",paddingLeft:12},image:{height:48,width:48,marginLeft:8}}),pt=function(e){var t=Object(i.useSelector)((function(e){return e.ac.settings.power}));return Object(Se.jsx)($e,{dispatchAction:ne,empty:!t,children:Object(Se.jsxs)(me.default,{style:ft.imageContainer,children:[Object(Se.jsx)(dt,{direction:"down"}),Object(Se.jsx)(at.default,{source:n(380),style:ft.image})]})})},gt=o.default.create({imageContainer:{flex:1,justifyContent:"center",alignItems:"center",flexDirection:"row",paddingLeft:12},image:{height:48,width:48,marginLeft:8}}),jt=function(e){var t=Object(i.useSelector)((function(e){return e.ac.settings.power}));return Object(Se.jsx)($e,{dispatchAction:te,empty:!t,children:Object(Se.jsxs)(me.default,{style:gt.imageContainer,children:[Object(Se.jsx)(dt,{direction:"up"}),Object(Se.jsx)(at.default,{source:n(381),style:gt.image})]})})},bt=o.default.create({buttons:{flexDirection:"row",width:"100%",height:"55%",paddingVertical:32},powerButtonContainer:{flexDirection:"row-reverse",width:"100%",height:"55%"},buttonsColumn:{flexDirection:"column",flex:1,alignItems:"center",justifyContent:"space-between"},emptySpace:{width:128,height:64}}),ht=function(e){var t=Object(i.useSelector)((function(e){return e.ac.settings.power}));return Object(Se.jsx)(Se.Fragment,{children:Object(Se.jsx)(me.default,{style:bt.buttons,children:Object(Se.jsxs)(Se.Fragment,{children:[Object(Se.jsx)(me.default,{style:bt.buttonsColumn,children:t&&Object(Se.jsxs)(Se.Fragment,{children:[Object(Se.jsx)(jt,{}),Object(Se.jsx)(pt,{}),Object(Se.jsx)(ot,{})]})}),Object(Se.jsxs)(me.default,{style:bt.buttonsColumn,children:[Object(Se.jsx)(ct,{}),t&&Object(Se.jsxs)(Se.Fragment,{children:[Object(Se.jsx)(tt,{}),Object(Se.jsx)(me.default,{style:bt.emptySpace})]})]})]})})})},Ot=o.default.create({component:{flexDirection:"row",justifyContent:"flex-start"},generalText:{fontWeight:"bold"},temperatureText:{fontSize:128},units:{fontSize:32,fontWeight:"bold"}}),yt=function(e){var t=Object(i.useSelector)((function(e){return e.ac.settings.temperature})),n=Object(i.useSelector)((function(e){return e.ac.settings.mode})),r=Object(be.useState)({}),o=ge()(r,2),a=o[0],c=o[1];return Object(be.useEffect)((function(){c(["fan"===n?{color:y}:{color:g}])}),[n]),Object(Se.jsxs)(me.default,{style:Ot.component,children:[Object(Se.jsx)(Ce.default,{style:[Ot.generalText,Ot.temperatureText,a],children:"fan"===n?"N/A":t}),Object(Se.jsx)(Ce.default,{style:[Ot.generalText,Ot.units,a],children:"fan"!==n&&"\xb0C"})]})},mt=o.default.create({component:{flexDirection:"row",height:"100%",alignItems:"flex-end"},text:{color:g},icon:{margin:5}}),xt=function(e){var t=Object(i.useSelector)((function(e){return e.ac.settings.fanSpeed}));return"auto"===t?Object(Se.jsx)(me.default,{style:mt.component,children:Object(Se.jsx)(Ye.default,{name:"fan-auto",size:32,color:g,style:mt.icon})}):Object(Se.jsxs)(me.default,{style:mt.component,children:[Object(Se.jsx)(me.default,{children:Object(Se.jsx)(et.default,{name:"fan",size:16,color:g,style:mt.icon})}),("medium"===t||"high"===t)&&Object(Se.jsx)(me.default,{children:Object(Se.jsx)(et.default,{name:"fan",size:24,color:g,style:mt.icon})}),"high"===t&&Object(Se.jsx)(me.default,{children:Object(Se.jsx)(et.default,{name:"fan",size:32,color:g,style:mt.icon})})]})},wt=o.default.create({component:{flexDirection:"column",justifyContent:"space-between",alignItems:"center"}}),vt=function(e){var t=Object(i.useSelector)((function(e){return e.ac.settings.mode}));return Object(Se.jsxs)(me.default,{style:wt.component,children:["cool"===t&&Object(Se.jsx)(et.default,{name:"snowflake",size:32,color:g}),"dry"===t&&Object(Se.jsx)(Ze.default,{name:"water",size:32,color:g}),"fan"===t&&Object(Se.jsx)(et.default,{name:"fan",size:32,color:g}),"heat"===t&&Object(Se.jsx)(et.default,{name:"sun",size:32,color:g}),"auto"===t&&Object(Se.jsx)(nt.default,{name:"brightness-auto",size:32,color:g})]})},Ct=o.default.create({component:{flex:1,width:"100%",padding:32,justifyContent:"center",alignItems:"center",backgroundColor:l,borderRadius:8,shadowColor:"black",shadowRadius:8,shadowOpacity:.4,shadowOffset:{height:4,width:0},elevation:1},bottomBar:{width:"100%",height:42,marginTop:32,justifyContent:"space-between",flexDirection:"row"},offText:{fontSize:32,color:g},infoText:{fontSize:18,fontWeight:"bold",textAlignVertical:"center",color:d}}),St=function(e){var t=Object(i.useSelector)((function(e){return e.ac}));return Object(Se.jsx)(me.default,{style:Ct.component,children:t.settings.power?Object(Se.jsxs)(Se.Fragment,{children:[Object(Se.jsx)(yt,{}),Object(Se.jsxs)(me.default,{style:Ct.bottomBar,children:[Object(Se.jsx)(xt,{}),t.correctionMode&&Object(Se.jsx)(Ce.default,{style:Ct.infoText,children:"CORRECTION MODE!"}),Object(Se.jsx)(vt,{})]})]}):Object(Se.jsx)(Ce.default,{style:Ct.offText,children:"Turn me on, baby!"})})},kt=o.default.create({component:{flex:1,marginHorizontal:"6%",marginVertical:"12%",justifyContent:"center",alignItems:"center"},display:{flexDirection:"row",width:"100%",height:"35%",borderWidth:1,borderColor:"white"}}),Pt=function(e){return Object(Se.jsxs)(me.default,{style:kt.component,children:[Object(Se.jsx)(St,{}),Object(Se.jsx)(ht,{})]})},Tt=(o.default.create({component:{}}),function(e){var t=e.navigation,n=Object(i.useDispatch)(),r=Object(i.useSelector)((function(e){return e.ac.settings.power}));return Object(be.useLayoutEffect)((function(){t.setOptions({headerRight:function(){return Object(Se.jsx)(qe,{})}}),n(ie())}),[r,t]),Object(Se.jsx)(Pt,{})}),Lt=n(290),Dt=function(e){var t=e.onPress,n=e.isLoading,r=e.disabled;e.children;return Object(Se.jsx)(ve.default,{style:function(e){var t=e.pressed;return[Et.button,t&&Et.pressed]},onPress:t,disabled:n||r,children:Object(Se.jsx)(Lt.default,{name:"user",size:24,color:g})})},Et=o.default.create({button:{borderRadius:12,borderColor:g,borderWidth:1,elevation:2,shadowColor:"black",shadowOffset:{width:1,height:1},shadowOpacity:.25,shadowRadius:4},pressed:{opacity:.7},buttonText:{textAlign:"center",color:g,fontSize:16,fontWeight:"bold"}}),At=function(e,t,n){return o.default.create({component:{position:"absolute",top:e[0][0]-2,start:e[0][1]-2,width:t,height:n,backgroundColor:g}})},It=function(e){var t=e.points,n=t[0][0]===t[1][0]&&t[0][1]!==t[1][1],r=n?t[1][1]-t[0][1]+2:4,o=n?4:t[1][0]-t[0][0]+2,a=At(t,r,o);return Object(Se.jsx)(me.default,{style:a.component})};function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Rt=function(e){var t=0,n=0;return e.forEach((function(e){return e.geometry.coordinates.forEach((function(e){return e.forEach((function(e){t<e[0]&&(t=e[0]),n<e[1]&&(n=e[1])}))}))})),{maxX:t,maxY:n}},Ft=function(e,t){return function(e,t){var n=Rt(t),r=n.maxX,o=n.maxY;return t.map((function(t){var n=t.geometry.coordinates.map((function(t){return t.map((function(t,n){return[(t[0]-r/2)/e+1*n,(t[1]-o/2)/e+1*n]}))}));return Bt(Bt({},t),{},{geometry:{type:t.geometry.type,coordinates:n}})}))}(2.1,e)},Nt=function(e,t,n){return function(e,t,n){var r=Rt(n),o=r.maxX,a=r.maxY;return t.map((function(t,n){return{points:t.points.map((function(t){return[(t[0]-o/2)/e+0*n,(t[1]-a/2)/e+0*n]}))}}))}(n,e,t)},Wt=(o.default.create({component:{}}),function(e){return Object(Se.jsx)(Se.Fragment,{children:Nt(U,X,2.1).map((function(e){return Object(Se.jsx)(It,{points:e.points},""+e.points[0][0]+e.points[0][1]+e.points[1][0]+e.points[1][1])}))})});function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Mt=function(e){var t=Math.abs(e[0][0]-e[2][0]),n=Math.abs(e[0][1]-e[1][1]);return o.default.create({polygon:{width:n,height:t}}).polygon},_t=o.default.create({component:{justifyContent:"center",alignItems:"center"},label:{color:g,fontSize:8}}),Jt=function(e){var t,n=Object(i.useDispatch)(),r=e.coordinates,a=e.properties,c=Object(i.useSelector)((function(e){var t;return!(null==(t=e.home.rooms.find((function(e){return e.properties.id===a.id})))||!t.properties.isLightOn)})),u=c?h:void 0;return u=a.empty?g:u,Object(Se.jsx)(ve.default,{onPress:function(){a.empty||n(Z({roomId:a.id}))},style:(t=r,o.default.create({polygon:{position:"absolute",top:t[0][0],start:t[0][1]}}).polygon),children:Object(Se.jsx)(me.default,{style:Vt(Vt(Vt({},Mt(r)),_t.component),{},{backgroundColor:u}),children:Object(Se.jsx)(Ce.default,{style:Vt(Vt({},_t.label),{},{color:c?s:g}),children:a.name})})})},Ut=(o.default.create({component:{}}),function(e){return Object(Se.jsx)(Se.Fragment,{children:Ft(X).map((function(e){return e.geometry.coordinates.map((function(t,n){return Object(Se.jsx)(Jt,{coordinates:t,properties:e.properties},e.properties.name+n)}))}))})}),Xt=o.default.create({component:{flex:1,justifyContent:"center",alignItems:"center"},imageContainer:{position:"absolute",end:"10%",top:"10%",height:150,width:150},image:{height:150,width:150}}),Kt=function(e){var t=Object(xe.useNavigation)().navigate;return Object(Se.jsxs)(me.default,{style:Xt.component,children:[Object(Se.jsx)(ve.default,{onPress:function(){return t("AcRemote")},style:Xt.imageContainer,children:Object(Se.jsx)(at.default,{source:n(382),style:Xt.image})}),Object(Se.jsxs)(me.default,{children:[Object(Se.jsx)(Ut,{}),Object(Se.jsx)(Wt,{})]})]})},Yt=o.default.create({rootContainer:{flex:1},title:{fontSize:20,fontWeight:"bold",marginBottom:8},imageContainer:{height:50,width:50,backgroundColor:"pink"},image:{height:50,width:50}}),Zt=function(e){var t=e.navigation;return Object(be.useLayoutEffect)((function(){t.setOptions({headerRight:function(){return Object(Se.jsx)(Dt,{onPress:function(){return t.navigate("Profile")}})}})}),[t]),Object(Se.jsx)(me.default,{style:Yt.rootContainer,children:Object(Se.jsx)(Kt,{})})};function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var qt=Object(Je.default)(),Qt=function(e){var t=e.navigation,n=e.state,r=Object(i.useDispatch)();return Object(Se.jsxs)(Ue.default,{contentContainerStyle:{justifyContent:"space-between",flex:1,paddingBottom:64,backgroundColor:s,paddingTop:100},children:[Object(Se.jsxs)(me.default,{children:[Object(Se.jsx)(Xe.default,{label:"Air Conditioner",focused:"Air Conditioner"===n.routeNames[n.index],icon:function(e){return Object(Se.jsx)(Ye.default,{name:"air-conditioner",size:24,color:e.focused?s:l})},activeTintColor:s,inactiveTintColor:l,activeBackgroundColor:l,inactiveBackgroundColor:u,onPress:function(){return t.navigate("Air Conditioner")}}),Object(Se.jsx)(Xe.default,{label:"Lights",focused:"Lights"===n.routeNames[n.index],icon:function(e){return Object(Se.jsx)(Ye.default,{name:"lightbulb",size:24,color:e.focused?s:l})},activeTintColor:s,inactiveTintColor:l,activeBackgroundColor:l,inactiveBackgroundColor:u,onPress:function(){return e.navigation.navigate("Lights")}})]}),Object(Se.jsx)(me.default,{children:Object(Se.jsx)(Xe.default,{label:"Logout",inactiveTintColor:f,inactiveBackgroundColor:p,onPress:function(){return r(H())}})})]})},$t=function(){return console.log("RENDER AuthenticatedDrawer"),Object(Se.jsxs)(qt.Navigator,{screenOptions:{headerStyle:{backgroundColor:s},headerShadowVisible:!1,headerTintColor:g,drawerContentStyle:{backgroundColor:l},sceneContainerStyle:{backgroundColor:s},headerLeft:function(){return Object(Se.jsx)(Ke.default,{tintColor:l})}},drawerContent:function(e){return Object(Se.jsx)(Qt,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))},children:[Object(Se.jsx)(qt.Screen,{name:"Air Conditioner",component:Tt}),Object(Se.jsx)(qt.Screen,{name:"Lights",component:Zt})]})},en=function(){var e=Object(i.useDispatch)(),t=Object(be.useState)(!1),n=ge()(t,2),r=n[0],o=n[1],a=Object(be.useRef)(new WebSocket("wss://smart-home-dec.herokuapp.com/cable/")).current,s=Object(i.useSelector)((function(e){return e.auth.username})),u=Object(i.useSelector)((function(e){return E(e.auth)}));return Object(be.useLayoutEffect)((function(){(function(){var t=w()((function*(){var t=yield R();t&&null!=t&&t.refreshToken&&(console.log("saved data is present"),E(t)?(console.log("saved data is still valid"),yield e(_(t))):(console.log("saved data is not valid, using refresh token"),yield e(W(t)))),yield e(ie()),o(!0),Object(c.hideAsync)()}));return function(){return t.apply(this,arguments)}})()()}),[]),Object(be.useEffect)((function(){a.onopen=function(){console.log("connected"),a.send('{"command":"subscribe","identifier": "{\\"channel\\":\\"AirConditionerChannel\\"}"}')},a.onmessage=function(t){var n,r=JSON.parse(t.data);console.log(r),null!=(n=r.message)&&n.state&&r.message.user!==s&&(console.log("passed if check"),e(le(r.message.state)))},a.onerror=function(e){},a.onclose=function(e){}}),[s]),r?(console.log("RENDER Navigation"),Object(Se.jsx)(je.default,{children:u?Object(Se.jsx)($t,{}):Object(Se.jsx)(_e,{})})):null};function tn(){return Object(Se.jsxs)(a.SafeAreaProvider,{children:[Object(Se.jsx)(r.StatusBar,{style:"light"}),Object(Se.jsx)(i.Provider,{store:fe,children:Object(Se.jsx)(en,{})})]})}Object(c.preventAutoHideAsync)();o.default.create({container:{flex:1,backgroundColor:s,color:g}})},331:function(e,t,n){e.exports=n(461)},378:function(e,t,n){e.exports=n.p+"static/media/off.a5b38215.png"},379:function(e,t,n){e.exports=n.p+"static/media/on.c7cf9c21.png"},380:function(e,t,n){e.exports=n.p+"static/media/cold.28e49a1b.png"},381:function(e,t,n){e.exports=n.p+"static/media/hot.a3bc03ae.png"},382:function(e,t,n){e.exports=n.p+"static/media/air-conditioner-colored.f53f3bbe.png"}},[[331,1,2]]]);
//# sourceMappingURL=app.5b27c579.chunk.js.map